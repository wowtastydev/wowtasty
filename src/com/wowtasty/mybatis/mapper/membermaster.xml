<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="membermaster">

	<sql id="columns"> 
		MemberID, Email, Password, Auth, FirstName, LastName, Telephone, Address
		, Suite, City, Province, PostalCode, DelivFirstName, DelivLastName, DelivTelephone
		, DelivAddress, DelivSuite, DelivBuzzer, DelivCity, DelivProvince, DelivPostalCode, DelivInstruction
		, Ecash, Status, TotalOrderCnt, RegisterDate, NAFlag, UpdateID, UpdateTime
	</sql>
	
	<!--select-->
	<select id="select" parameterType="java.util.List" resultType="membermastervo">
	SELECT 
		MemberID, Email, Password, Auth, Get_CdShortName('006', Auth) as AuthName
		, FirstName, LastName, Telephone, Address
		, Suite, City, Province, PostalCode, DelivFirstName, DelivLastName, DelivTelephone
		, DelivAddress, DelivSuite, DelivBuzzer, DelivCity, DelivProvince, DelivPostalCode, DelivInstruction
		, Ecash, Status, TotalOrderCnt, RegisterDate, NAFlag, UpdateID, UpdateTime
	FROM member_master 
	WHERE auth in 
	<foreach item="item" index="index" collection="list" open="(" separator="," close=")">
          #{item}
    </foreach>
	ORDER BY MemberID
	</select>
	
	<!--selectByID-->
	<select id="selectByID" parameterType="String" resultType="membermastervo">
	SELECT 
	<include refid="columns"/>
	FROM member_master 
	WHERE MemberID = #{id}
	</select>
	
	<!--selectByEmail-->
	<select id="selectByEmail" parameterType="String" resultType="membermastervo">
	SELECT 
	<include refid="columns"/>
	FROM member_master 
	WHERE Email = #{email}
	</select>
	
	<!--selectMaxID-->
	<select id="selectMaxID" resultType="java.lang.String">
	SELECT Create_MaxID(1)
	</select>
	
	<!--Insert-->
	<insert id = "insert" parameterType="membermastervo">
	INSERT INTO member_master
	( 	
	<include refid="columns"/>
	)
	VALUES
	(	#{memberID},
		TRIM(#{email}),
		#{password},
		#{auth},
		TRIM(#{firstName}),
		TRIM(#{lastName}),
		TRIM(#{telephone}),
		TRIM(#{address}),
		TRIM(#{suite}),
		#{city},
		#{province},
		UPPER(TRIM(REPLACE(#{postalCode},' ',''))),
		TRIM(#{delivFirstName}),
		TRIM(#{delivLastName}),
		TRIM(#{delivTelephone}),
		TRIM(#{delivAddress}),
		TRIM(#{delivSuite}),
		TRIM(#{delivBuzzer}),
		#{delivCity},
		#{delivProvince},
		UPPER(TRIM(REPLACE(#{delivPostalCode},' ',''))),
		TRIM(#{delivInstruction}),
		TRIM(#{ecash}),
		#{status},
		#{totalOrderCnt},
		now(),
		#{naFlag},
		#{updateID},
		now())
	</insert>
	
	<!--Update-->
	<update id = "update" parameterType="membermastervo">
		UPDATE member_master
		SET Email = TRIM(#{email}),
			Password = #{password},
			Auth = #{auth},
			FirstName = TRIM(#{firstName}),
			LastName = TRIM(#{lastName}),
			Telephone = TRIM(#{telephone}),
			Address = TRIM(#{address}),
			Suite = TRIM(#{suite}),
			City = #{city},
			Province = #{province},
			PostalCode = UPPER(TRIM(REPLACE(#{postalCode},' ',''))),
			DelivFirstName = TRIM(#{delivFirstName}),
			DelivLastName = TRIM(#{delivLastName}),
			DelivTelephone = TRIM(#{delivTelephone}),
			DelivAddress = TRIM(#{delivAddress}),
			DelivSuite = TRIM(#{delivSuite}),
			DelivBuzzer = TRIM(#{delivBuzzer}),
			DelivCity = #{delivCity},
			DelivProvince = #{delivProvince},
			DelivPostalCode = UPPER(TRIM(REPLACE(#{delivPostalCode},' ',''))),
			DelivInstruction = TRIM(#{delivInstruction}),
			Ecash = TRIM(#{ecash}),
			Status = #{status},
			TotalOrderCnt = #{totalOrderCnt}, 
			RegisterDate = #{registerDate},
			NAFlag = #{naFlag},
			UpdateID = #{updateID},
			UpdateTime = now() 
		WHERE 
		  	MemberID = #{memberID}

	</update>
</mapper>