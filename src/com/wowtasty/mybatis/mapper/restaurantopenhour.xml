<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="restaurantopenhour">

	<sql id="columns"> 
		RestaurantID,WeekDay,Seq,StartTime,EndTime
	</sql>

	<!--selectByID : Restaurant 1st and 2nd Open Hour list -->
	<select id="selectByID" parameterType="String" resultType="hourlistvo">
	SELECT RestaurantID AS ID, WeekDay
		,CAST( MAX(IF(Seq = 1, StartTime, '')) AS CHAR(5)) AS startTime1
		,CAST( MAX(IF(Seq = 1, EndTime, '')) AS CHAR(5)) AS endTime1
		,CAST( MAX(IF(Seq = 2, StartTime, '')) AS CHAR(5)) AS startTime2
		,CAST( MAX(IF(Seq = 2, EndTime, '')) AS CHAR(5)) AS endTime2
	FROM restaurant_open_hour
	WHERE RestaurantID = #{id} 
	GROUP BY RestaurantID, WeekDay
	ORDER BY WeekDay
	</select>
		
	<!--Insert-->
	<insert id = "insert" parameterType="restaurantopenhourvo">
	INSERT INTO restaurant_open_hour
	( 	
		<include refid="columns"/>
		)
	VALUES
	(	#{restaurantID},
		#{weekDay},
		#{seq},
		#{startTime},
		#{endTime})
	</insert>
	
	<!--Update-->
	<update id = "update" parameterType="restaurantopenhourvo">
		UPDATE restaurant_open_hour
		SET StartTime = #{startTime},
			EndTime = #{endTime}
		WHERE RestaurantID = #{restaurantID} 
		  AND WeekDay = #{weekDay}
		  AND Seq = #{seq}
	</update>
	
	<!--Delete-->
	<delete id = "delete" parameterType="restaurantopenhourvo">
		DELETE FROM restaurant_open_hour
		WHERE RestaurantID = #{restaurantID} 
		  AND WeekDay = #{weekDay}
		  AND Seq = #{seq}
	</delete>
</mapper>